# ğŸ‰ NiTrite v3.1 - BOUTONS DIRECTS POUR COMMANDES SYSTÃˆME

## ğŸ“… Date : 3 novembre 2025

---

## ğŸ¯ NouveautÃ©s v3.1

### Interface rÃ©volutionnÃ©e pour les commandes systÃ¨me

**AVANT (v3.0.1) :**
- âŒ Fallait cocher + cliquer "Installer"
- âŒ Pas intuitif pour des paramÃ¨tres

**MAINTENANT (v3.1) :**
- âœ… **Bouton direct** pour chaque commande
- âœ… **2 types de boutons** selon le type de commande

---

## ğŸ¨ Les 2 types de boutons

### 1. Bouton "ğŸ“‹ ExÃ©cuter" (OR - #FFD700)
**Pour les commandes DISM / SFC / RÃ©paration Windows**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DISM - VÃ©rifier l'Ã©tat                    ğŸ“‹ ExÃ©cuter â”‚
â”‚ DISM - RÃ©parer l'image                    ğŸ“‹ ExÃ©cuter â”‚
â”‚ SFC - VÃ©rifier fichiers systÃ¨me           ğŸ“‹ ExÃ©cuter â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Comportement :**
1. Clic sur "ğŸ“‹ ExÃ©cuter"
2. **Un terminal PowerShell s'ouvre EN ADMIN**
3. La commande s'exÃ©cute automatiquement
4. Les logs apparaissent en temps rÃ©el
5. Terminal reste ouvert Ã  la fin (appuyer sur une touche pour fermer)

**Exemple de terminal qui s'ouvre :**
```powershell
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  DISM - VÃ©rifier l'Ã©tat
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Outil DISM (Deployment Image Servicing and Management)
Version: 10.0.22621.1

Image Windows Version 10.0.22621.1

L'Ã©tat de l'image systÃ¨me est SAIN.
Aucun composant endommagÃ© dÃ©tectÃ©.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  TerminÃ© ! Appuyez sur une touche pour fermer...
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 2. Bouton "âš™ï¸ Ouvrir" (CYAN - #00D4FF)
**Pour les paramÃ¨tres Windows**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RÃ©seau et Internet                          âš™ï¸ Ouvrir â”‚
â”‚ Son                                         âš™ï¸ Ouvrir â”‚
â”‚ Bluetooth et appareils                      âš™ï¸ Ouvrir â”‚
â”‚ Panneau de configuration                    âš™ï¸ Ouvrir â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Comportement :**
1. Clic sur "âš™ï¸ Ouvrir"
2. **La fenÃªtre de paramÃ¨tres s'ouvre IMMÃ‰DIATEMENT**
3. Pas de terminal, redirection directe
4. Interface Windows native

---

## ğŸ“‹ Interface dÃ©taillÃ©e

### CatÃ©gorie "ğŸ”§ RÃ©paration Windows" (8 boutons OR)

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”§ RÃ©paration Windows (8 programmes)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DISM - VÃ©rifier l'Ã©tat                                       â”‚
â”‚ VÃ©rification rapide de l'Ã©tat de l'image Windows            â”‚
â”‚                                              [ğŸ“‹ ExÃ©cuter]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DISM - Scanner l'image                                       â”‚
â”‚ Scan approfondi de l'image Windows (peut prendre du temps)  â”‚
â”‚                                              [ğŸ“‹ ExÃ©cuter]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DISM - RÃ©parer l'image                                       â”‚
â”‚ RÃ©pare l'image Windows en utilisant Windows Update          â”‚
â”‚                                              [ğŸ“‹ ExÃ©cuter]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ... 5 autres commandes avec boutons                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### CatÃ©gorie "âš™ï¸ ParamÃ¨tres Windows" (19 boutons CYAN)

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš™ï¸ ParamÃ¨tres Windows (19 programmes)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RÃ©seau et Internet                                           â”‚
â”‚ Configuration rÃ©seau, Wi-Fi, Ethernet, VPN                   â”‚
â”‚                                                [âš™ï¸ Ouvrir]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Son                                                           â”‚
â”‚ Volume, pÃ©riphÃ©riques audio, mixage                          â”‚
â”‚                                                [âš™ï¸ Ouvrir]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Bluetooth et appareils                                       â”‚
â”‚ Gestion Bluetooth, imprimantes, souris, clavier             â”‚
â”‚                                                [âš™ï¸ Ouvrir]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ... 16 autres paramÃ¨tres avec boutons                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### CatÃ©gorie "Outils OrdiPlus" (12 checkboxes ORANGE)
**Les programmes normaux gardent le systÃ¨me de checkboxes**

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸŸ  Outils OrdiPlus (12 programmes)

â˜ Mozilla Firefox    â˜ AnyDesk         â˜ RustDesk
â˜ Spybot S&D        â˜ Malwarebytes    â˜ AdwCleaner
â˜ Wise Disk Cleaner â˜ Adobe Reader    â˜ VLC Media Player
â˜ Office 2007       â˜ Office 2024     â˜ LibreOffice

[Installer les programmes sÃ©lectionnÃ©s]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ”§ DÃ©tails techniques

### Script PowerShell temporaire (DISM)

Quand vous cliquez sur "ğŸ“‹ ExÃ©cuter" pour une commande DISM, un fichier `temp_dism.ps1` est crÃ©Ã© :

```powershell
Write-Host "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
Write-Host "  DISM - VÃ©rifier l'Ã©tat" -ForegroundColor Yellow
Write-Host "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
Write-Host ""

# ExÃ©cuter la commande
DISM /Online /Cleanup-Image /CheckHealth

Write-Host ""
Write-Host "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
Write-Host "  TerminÃ© ! Appuyez sur une touche..." -ForegroundColor Green
Write-Host "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
```

**Puis le terminal est lancÃ© avec Ã©lÃ©vation admin :**
```powershell
Start-Process powershell -Verb RunAs -ArgumentList '-ExecutionPolicy Bypass -NoExit -File "temp_dism.ps1"'
```

### Redirection paramÃ¨tres (ms-settings)

Pour les paramÃ¨tres Windows :
```powershell
# RÃ©seau
Start-Process "ms-settings:network"

# Son
Start-Process "ms-settings:sound"

# Bluetooth
Start-Process "ms-settings:bluetooth"

# Panneau de configuration
control
```

---

## ğŸ“Š Comparaison v3.0.1 vs v3.1

```
FONCTIONNALITÃ‰           v3.0.1              v3.1
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ParamÃ¨tres Windows       Checkbox            Bouton âš™ï¸ Ouvrir
DISM/SFC                 Checkbox            Bouton ğŸ“‹ ExÃ©cuter
Programmes Winget        Checkbox            Checkbox (inchangÃ©)

Ouverture paramÃ¨tres     Via "Installer"     Clic direct
ExÃ©cution DISM           Via "Installer"     Terminal auto
Terminal pour DISM       Non                 OUI (reste ouvert)
Ã‰lÃ©vation admin          Globale             Par commande
```

---

## ğŸš€ Utilisation v3.1

### Exemple 1 : Ouvrir les paramÃ¨tres rÃ©seau
```
1. Lance NiTrite
2. Trouve "âš™ï¸ ParamÃ¨tres Windows" (section cyan)
3. Cherche "RÃ©seau et Internet"
4. Clique sur le bouton [âš™ï¸ Ouvrir]
5. âœ¨ La fenÃªtre s'ouvre instantanÃ©ment !
```

### Exemple 2 : RÃ©parer Windows avec DISM
```
1. Lance NiTrite (mode normal, pas besoin d'Ãªtre admin)
2. Trouve "ğŸ”§ RÃ©paration Windows" (section or)
3. Cherche "DISM - RÃ©parer l'image"
4. Clique sur le bouton [ğŸ“‹ ExÃ©cuter]
5. âœ¨ Windows demande l'Ã©lÃ©vation admin (UAC)
6. âœ¨ Terminal PowerShell s'ouvre automatiquement
7. âœ¨ La commande DISM s'exÃ©cute avec les logs
8. âœ¨ Terminal reste ouvert pour voir le rÃ©sultat
```

### Exemple 3 : Ouvrir le gestionnaire de pÃ©riphÃ©riques
```
1. Lance NiTrite
2. Trouve "âš™ï¸ ParamÃ¨tres Windows"
3. Cherche "Gestionnaire de pÃ©riphÃ©riques"
4. Clique sur [âš™ï¸ Ouvrir]
5. âœ¨ Le gestionnaire s'ouvre !
```

### Exemple 4 : Installer Firefox (programme normal)
```
1. Lance NiTrite
2. Trouve "ğŸŸ  Outils OrdiPlus"
3. Coche â˜‘ "Mozilla Firefox"
4. Clique sur "Installer les programmes sÃ©lectionnÃ©s"
5. âœ¨ Firefox s'installe via Winget
```

---

## ğŸ¨ Avantages de l'interface v3.1

### âœ… Plus intuitif
- Bouton "Ouvrir" = action immÃ©diate (pas besoin de cocher + valider)
- 1 clic au lieu de 2

### âœ… Plus clair
- **OR** = Commandes de maintenance (avec terminal)
- **CYAN** = ParamÃ¨tres systÃ¨me (ouverture directe)
- **Checkbox** = Installation de programmes

### âœ… Plus rapide
- ParamÃ¨tres s'ouvrent instantanÃ©ment
- DISM se lance avec un seul clic

### âœ… Plus professionnel
- Terminal qui reste ouvert pour DISM
- Logs bien formatÃ©s avec couleurs
- Message de fin explicite

---

## ğŸ”’ SÃ©curitÃ© et privilÃ¨ges

### Commandes DISM (admin requis)
```
Comportement :
1. Clic sur [ğŸ“‹ ExÃ©cuter]
2. Windows affiche UAC (demande mot de passe admin)
3. Si acceptÃ© â†’ Terminal admin s'ouvre
4. Si refusÃ© â†’ Rien ne se passe (sÃ©curisÃ©)
```

### ParamÃ¨tres Windows (pas d'admin)
```
Comportement :
1. Clic sur [âš™ï¸ Ouvrir]
2. FenÃªtre s'ouvre directement
3. Pas de demande admin (normal)
```

### msconfig (cas spÃ©cial)
```
Comportement :
1. Clic sur [âš™ï¸ Ouvrir]
2. Windows demande UAC (msconfig nÃ©cessite admin)
3. Si acceptÃ© â†’ msconfig s'ouvre
4. Si refusÃ© â†’ Message d'erreur Windows
```

---

## ğŸ“ Code ajoutÃ©

### Nouvelle mÃ©thode dans `gui_manager_winget.py`

```python
def _execute_system_command(self, command_name: str, is_repair: bool):
    """ExÃ©cute une commande systÃ¨me immÃ©diatement"""
    
    if is_repair:
        # DISM/SFC : Terminal PowerShell admin avec script
        ps_script = f"""
        Write-Host "â•â•â•â•â•â•â•" -ForegroundColor Cyan
        Write-Host "  {command_name}" -ForegroundColor Yellow
        Write-Host "â•â•â•â•â•â•â•" -ForegroundColor Cyan
        
        {command}
        
        Write-Host "  TerminÃ© !" -ForegroundColor Green
        $null = $Host.UI.RawUI.ReadKey()
        """
        
        subprocess.Popen([
            'powershell', '-Command',
            f'Start-Process powershell -Verb RunAs -ArgumentList ...'
        ])
    
    else:
        # ParamÃ¨tres : Redirection directe
        subprocess.Popen(['powershell', '-Command', f'Start-Process "{uri}"'])
```

### Interface avec boutons

```python
# DÃ©tection : commandes systÃ¨me vs programmes
is_system_category = any('command' in prog for prog in programs.values())

if is_system_category:
    # Boutons pour commandes systÃ¨me
    btn_text = "ğŸ“‹ ExÃ©cuter" if is_repair else "âš™ï¸ Ouvrir"
    btn_color = '#FFD700' if is_repair else '#00D4FF'
    
    exec_btn = tk.Button(
        text=btn_text,
        command=lambda: self._execute_system_command(name, is_repair),
        bg=btn_color
    )
else:
    # Checkboxes pour programmes
    cb = ttk.Checkbutton(...)
```

---

## âœ… Checklist v3.1

- [x] Boutons "âš™ï¸ Ouvrir" pour paramÃ¨tres (19 boutons)
- [x] Boutons "ğŸ“‹ ExÃ©cuter" pour DISM/SFC (8 boutons)
- [x] Terminal PowerShell auto avec Ã©lÃ©vation admin
- [x] Script temporaire temp_dism.ps1
- [x] Terminal reste ouvert aprÃ¨s exÃ©cution
- [x] Logs formatÃ©s avec couleurs
- [x] Redirection directe pour ms-settings:*
- [x] Checkboxes conservÃ©es pour programmes Winget
- [x] Couleurs distinctives (OR/CYAN)
- [x] Interface intuitive et professionnelle

---

<div align="center">

## ğŸ‰ v3.1 - INTERFACE RÃ‰VOLUTIONNÃ‰E ! ğŸ‰

**27 boutons directs pour commandes systÃ¨me**

**ğŸ“‹ ExÃ©cuter (terminal) + âš™ï¸ Ouvrir (direct) = ExpÃ©rience optimale !** âœ¨

---

*Mise Ã  jour du 3 novembre 2025*

</div>
